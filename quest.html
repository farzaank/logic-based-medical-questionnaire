<html>
<head>
  <title></title>
  <meta charset="UTF-8">
  <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
<script src="https://www.kryogenix.org/code/browser/sorttable/sorttable.js"></script>
  <script src="http://epilog.stanford.edu//epilog/javascript/epilog.js"></script>
  <script src="http://epilog.stanford.edu//worksheets/javascript/worksheets.js"></script>
        <script src="http://epilog.stanford.edu//worksheets/widgets/charts.js"></script></head>
<body onload="initialize()" style="background-color: rgb(251,251,249)">
<table class="content-center" style="margin: 0px auto; width: 500;">
  <tbody>

    <tr>
      
    <td colspan="4"><a href="https://vaden.stanford.edu/"><img src="https://stanfordreview.org/content/images/caps.png" alt="Vaden Health Services" width="375" height="48" style="margin: 0px auto;"></a>
    </tr>
    <tr>
      <td colspan="4"><span style="font-size:20px;"><strong>&nbsp;Clinician Recommendation Form&nbsp;</strong>
    </tr>

    <tr>
      <td colspan="4" style="color: black;"><em>&nbsp;What you describe as your primary medical concerns?</em></td>
    </tr>
    <tr>
      <td colspan="4" id="c1" style="color: red;"><em>&nbsp; - Please select at least one concern</em></td>
    </tr>
    <tr>
      <td colspan="4">
      <table border="0" cellpadding="0" cellspacing="0" style="width: 100%; border-collapse: collapse; margin: 0px auto; font-family: HelveticaNeue-Light, &quot;Helvetica Neue&quot;, Helvetica, sans-serif;">
        <tbody>
          <tr>
            <td id="row(gennutrition)" style="width: 25%; background-color: rgba(255, 228, 242, 0.8);"><input id="gennutrition" onchange="modcheck(this)" type="checkbox" />&nbsp;General Nutrition</td>
            <td id="row(eatingdisorder)" style="width: 25%; background-color: rgba(255, 228, 242, 0.8);"><input id="eatingdisorder" onchange="modcheck(this)" type="checkbox" />&nbsp;Eating Disorder</td>
            <td id="row(fever)" style="width: 25%; background-color: rgba(255, 228, 242, 0.8);"><input id="fever" onchange="modcheck(this)" type="checkbox" />&nbsp;Fever</td>
          </tr>
          <tr>
            <td id="row(acne)" style="width: 25%; background-color: rgba(255, 228, 242, 0.8);"><input id="acne" onchange="modcheck(this)" type="checkbox" />&nbsp;Acne</td>
            <td id="row(genskin)" style="width: 25%; background-color: rgba(255, 228, 242, 0.8);"><input id="genskin" onchange="modcheck(this)" type="checkbox" />&nbsp;Other skin</td>
            <td id="row(rash)" style="width: 25%; background-color: rgba(255, 228, 242, 0.8);"><input id="rash" onchange="modcheck(this)" type="checkbox">&nbsp;Rash</td>
          </tr>
          <tr>
            <td id="row(anxiety)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="anxiety" onchange="modcheck(this)" type="checkbox" />&nbsp;Anxiety</td>
            <td id="row(depression)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="depression" onchange="modcheck(this)" type="checkbox" />&nbsp;Depression</td>
            <td id="row(skinirritation)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="skinirritation" onchange="modcheck(this)" type="checkbox" />&nbsp;Skin Irritation</td>
          </tr>
          <tr>
            <td id="row(diarrhea)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="diarrhea" onchange="modcheck(this)" type="checkbox" />&nbsp;Diarrhea</td>
            <td id="row(jointpain)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="jointpain" onchange="modcheck(this)" type="checkbox" />&nbsp;Joint Pain</td>
            <td id="row(wheeze)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="wheeze" onchange="modcheck(this)" type="checkbox" />&nbsp;Wheezing</td>
          </tr>

          <tr>
            <td id="row(palpitations)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="palpitations" onchange="modcheck(this)" type="checkbox" />&nbsp;Palpitations</td>
            <td id="row(vertigo)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="vertigo" onchange="modcheck(this)" type="checkbox" />&nbsp;Vertigo</td>
            <td id="row(headache)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="headache" onchange="modcheck(this)" type="checkbox" />&nbsp;Headache</td>
          </tr>

          <tr>
            <td id="row(abdominalpain)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="abdominalpain" onchange="modcheck(this)" type="checkbox" />&nbsp;Abdominal Pain</td>
            <td id="row(chestpain)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="chestpain" onchange="modcheck(this)" type="checkbox" />&nbsp;Chest Pain</td>
            <td id="row(throatpain)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="throatpain" onchange="modcheck(this)" type="checkbox" />&nbsp;Throat Pain</td>
          </tr>
        </tbody>
      </table>

    <tr>
      <td colspan="4"><span style="font-size:15px;"><strong>&nbsp;Optional Questions&nbsp;</strong>
    </tr>
      <tr>
        <td id="row(askloc)" style=""><input id="askloc" onchange="modcheck(this)" type="checkbox" />&nbsp;Do you have a location preference?</td>
        <table id="locquestion" style="margin: 0px auto; width: 500px; display: none;">
        <tr>
            <td id="row(east)" style="background-color: rgba(255, 255, 159, 0.8);"><input id="east" onchange="modcheck(this)" type="checkbox" />&nbsp;East Campus</td>
            <td id="row(west)" style="background-color: rgba(255, 255, 159, 0.8);"><input id="west" onchange="modcheck(this)" type="checkbox" />&nbsp;West Campus</td>
          </tr>
        </table>
      </tr>
      <table style="margin: 0px auto; width: 500px;">
      <tr >
        <td id="row(asktime)" ><input id="asktime" onchange="modcheck(this)" type="checkbox" />&nbsp;Do you have a time preference?</td>
        <table id="timequestion" style="margin: 0px auto; width: 500px; display: none;">
          <tr>
            <td id="row(morning)" style="background-color: rgba(255, 255, 159, 0.8);"><input id="morning" onchange="modcheck(this)" type="checkbox" />&nbsp;Morning</td>
            <td id="row(afternoon)" style="background-color: rgba(255, 255, 159, 0.8);"><input id="afternoon" onchange="modcheck(this)" type="checkbox" />&nbsp;Afternoon</td>
          </tr>
        </table>
      </tr>
      </table>
    </td>
    </tr>
      <table style="margin: 0px auto; width: 500px;">
    <tr>
      <td colspan="4"><span style="font-size:15px;"><strong>&nbsp;Results&nbsp;</strong>
    </tr>
  </table>
    <tr style="vertical-align: top;">
      <td colspan="4">
      <table border="0" cellpadding="0" cellspacing="0" style="margin: 0px auto; width: 500px;">
        <tbody>
          <tr style="vertical-align: top;">
            <td>
          <tr>
            <td id="row(showcats)" style="background-color: rgba(34, 167, 240, 0.298039);"><input id="showcats" onchange="modcheck(this)" type="checkbox" />&nbsp;Show care topic categories?</td>
          </tr>
          <tr>
            <td id="row(showrecs)" style="background-color: rgba(34, 167, 240, 0.298039);"><input id="showrecs" onchange="modcheck(this)" type="checkbox"/>&nbsp;Show care provider recommendations?</td>
          </tr>
              <chart chart-line-color="white" class="chart" widget="chart" style="margin: 0px auto; width: 500px; display: none;" chart-table="area" chart-type="pie" chart-title="Medical Categories" chart-y-axis-title="" chart-x-axis-title="" chart-color="" chart-data-range-labels="" chart-grid-lines="none" chart-legend="bottom" chart-line-width="" id="chart" ><canvas></canvas></chart>
            </td>          <td>
              <table class="sortable" table border="0" cellpadding="0" cellspacing="0" type='table' id="doctortab" style="width: 500px; font-family: HelveticaNeue-Light, 'Helvetica Neue', Helvetica, sans-serif; margin: 0px auto; text-align: center; visibility: hidden;">
                <thead>
                  <tr>
                    <th displaystyle="stringfield"> </th>
                    <th displaystyle="stringfield" > Clinician  </th>
                    <th displaystyle="stringfield"> Relevance</th>
                    <th> Specialties</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                  </tr>
                </tbody>
              </table>
            </td>
          </tr>
        </tbody>
      </table>
      </td>
    </tr>
  </tbody>
</table>
</div>

<textarea id="lambda" style="display:none;" type="text/hrf">
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Data
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

category("adolescent")
category("dermatology")
category("preventive")
category("sports")
category("travel")
category("urgent")
category("women")
category("mental")
category("nutrition")

symptom(acne)
symptom(rash)
symptom(diarrhea)
symptom(wheeze)
symptom(gennutrition)
symptom(eatingdisorder)
symptom(fever)
symptom(genskin)
symptom(anxiety)
symptom(abdominalpain)
symptom(chestpain)
symptom(cough)
symptom(depression)
symptom(fever)
symptom(headache)
symptom(heartburn)
symptom(itch)
symptom(jointpain)
symptom(palpitations)
symptom(runnynose)
symptom(shortbreath)
symptom(skinirritation)
symptom(throatpain)
symptom(vertigo)

categorySymptomSet("dermatology",[itch,skinirritation,genskin],50)
categorySymptomSet("dermatology",[itch,skinirritation,acne,genskin],100)
categorySymptomSet("dermatology",[itch,skinirritation,acne],18)
categorySymptomSet("dermatology",[itch,skinirritation],12)
categorySymptomSet("dermatology",[itch],5)
categorySymptomSet("dermatology",[rash],5)
categorySymptomSet("dermatology",[acne],5)
categorySymptomSet("dermatology",[genskin],5)
categorySymptomSet("dermatology",[skinirritation],5)
categorySymptomSet("adolescent",[itch,skinirritation],6)
categorySymptomSet("adolescent",[itch],2)
categorySymptomSet("adolescent",[skinirritation],3)
categorySymptomSet("sports",[headache,vertigo],10)
categorySymptomSet("sports",[headache],2)
categorySymptomSet("sports",[jointpain],5)
categorySymptomSet("sports",[vertigo],2)
categorySymptomSet("sports",[abdominalpain],4)
categorySymptomSet("sports",[abdominalpain,jointpain],8)
categorySymptomSet("urgent",[chestpain,headache,palpitations],100)
categorySymptomSet("urgent",[chestpain,shortbreath,wheeze],50)
categorySymptomSet("urgent",[chestpain,shortbreath],25)
categorySymptomSet("urgent",[chestpain,palpitations],15)
categorySymptomSet("urgent",[chestpain],4)
categorySymptomSet("urgent",[fever],5)
categorySymptomSet("urgent",[palpitations],5)
categorySymptomSet("urgent",[wheeze],8)
categorySymptomSet("preventive",[chestpain,headache,palpitations],100)
categorySymptomSet("preventive",[chestpain,palpitations,shortbreath],15)
categorySymptomSet("preventive",[chestpain],8)
categorySymptomSet("preventive",[palpitations],8)
categorySymptomSet("preventive",[abdominalpain],8)
categorySymptomSet("preventive",[shortbreath],8)
categorySymptomSet("preventive",[runnynose],8)
categorySymptomSet("preventive",[throatpain],8)
categorySymptomSet("mental",[depression],10)
categorySymptomSet("mental",[anxiety],10)
categorySymptomSet("mental",[eatingdisorder],5)
categorySymptomSet("mental",[anxiety,depression],20)
categorySymptomSet("nutrition",[gennutrition],10)
categorySymptomSet("nutrition",[jointpain],4)
categorySymptomSet("nutrition",[diarrhea],6)
categorySymptomSet("nutrition",[eatingdisorder],8)
categorySymptomSet("nutrition",[diarrhea,jointpain],9)

doctor("COLLOFF")
doctor("CUA")
doctor("CURRY")
doctor("DAWSON")
doctor("FARID")
doctor("GERSHON")
doctor("HONG")
doctor("KASTELEIN")
doctor("LAI")
doctor("LOMMEL")
doctor("MARANIA")
doctor("MARTIN")
doctor("PARK")
doctor("PENDLEY")
doctor("RICHARDS")
doctor("RODDEN")
doctor("STOLL")
doctor("TEPPER")
doctor("VU-NGUYEN")

doctorTime("COLLOFF",morning)
doctorTime("CUA",morning)
doctorTime("CURRY",morning)
doctorTime("DAWSON",morning)
doctorTime("FARID",morning)
doctorTime("GERSHON",morning)
doctorTime("HONG",morning)
doctorTime("KASTELEIN",morning)
doctorTime("LAI",morning)
doctorTime("LOMMEL",morning)
doctorTime("MARANIA",morning)
doctorTime("MARTIN",afternoon)
doctorTime("PARK",afternoon)
doctorTime("PENDLEY",afternoon)
doctorTime("RICHARDS",afternoon)
doctorTime("RODDEN",afternoon)
doctorTime("STOLL",afternoon)
doctorTime("TEPPER",afternoon)
doctorTime("VU-NGUYEN",afternoon)

doctorPlace("COLLOFF",east)
doctorPlace("CUA",west)
doctorPlace("CURRY",east)
doctorPlace("DAWSON",west)
doctorPlace("FARID",east)
doctorPlace("GERSHON",west)
doctorPlace("HONG",east)
doctorPlace("KASTELEIN",west)
doctorPlace("LAI",east)
doctorPlace("LOMMEL",west)
doctorPlace("MARANIA",east)
doctorPlace("MARTIN",west)
doctorPlace("PARK",east)
doctorPlace("PENDLEY",west)
doctorPlace("RICHARDS",east)
doctorPlace("RODDEN",west)
doctorPlace("STOLL",east)
doctorPlace("TEPPER",west)
doctorPlace("VU-NGUYEN",east)

doctorFullName("PENDLEY","Karen Pendley, RN, BSN")
doctorFullName("COLLOFF","Edwin Colloff, MD")
doctorFullName("RICHARDS","Julie Richards, NP, CTH")
doctorFullName("STOLL","Nancy Stoll, RN, MS, BC")
doctorFullName("DAWSON","Laurel Dawson, MD")
doctorFullName("VU-NGUYEN","Ann Vu-Nguyen, MSN, FNP")
doctorFullName("KASTELEIN","Michele Kastelein, MD")
doctorFullName("TEPPER","Robyn S. Tepper, MD, FAAFP")
doctorFullName("RODDEN","Ammie Wilson Rodden, PA-C")
doctorFullName("LOMMEL","Lisa Lommel, RN, PhD, FNP, MPH")
doctorFullName("FARID","Diana Farid, MD, MPH")
doctorFullName("MARANIA","Doug D. Marania, MD")
doctorFullName("LAI","Sandy Lai, MD")
doctorFullName("CURRY","Margaret Curry, RN, CTH")
doctorFullName("CUA","Racquel Cua, PA")
doctorFullName("HONG","Danielle Hong, RN")
doctorFullName("MARTIN","Susanne Martin, MD")
doctorFullName("PARK","Swon Park, RN")
doctorFullName("GERSHON","Megan Gershon, RN")

doctorCats("COLLOFF",["preventive"])
doctorCats("CUA",["urgent","women"])
doctorCats("CURRY",["adolescent","preventive"])
doctorCats("DAWSON",["preventive","women"])
doctorCats("FARID",["dermatology","preventive","women"])
doctorCats("GERSHON",["nutrition","mental","preventive"])
doctorCats("HONG",["adolescent"])
doctorCats("KASTELEIN",["preventive","sports","women"])
doctorCats("LAI",["preventive"])
doctorCats("LOMMEL",["adolescent","women"])
doctorCats("MARANIA",["sports"])
doctorCats("MARTIN",["adolescent","sports","urgent"])
doctorCats("PARK",["nutrition","preventive","sports"])
doctorCats("PENDLEY",["preventive"])
doctorCats("RICHARDS",["travel"])
doctorCats("RODDEN",["preventive","sports","women"])
doctorCats("STOLL",["adolescent","preventive","travel"])
doctorCats("TEPPER",["adolescent","nutrition","women"])
doctorCats("VU-NGUYEN",["adolescent","women"])

photo("Edwin Colloff, MD","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/ed_colloff_0_0.jpeg?h=9a223a1b&itok=cU1EsdFK")
photo("Julie Richards, NP, CTH","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/julie_0_0.jpeg?h=804a83ea&itok=_NY7PAzn")
photo("Nancy Stoll, RN, MS, BC","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/nancy_0_0.jpeg?h=92748315&itok=da5q70R5")
photo("Laurel Dawson, MD","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/larurel_0.jpeg?h=cee2c3b2&itok=HAFUwBdr")
photo("Ann Vu-Nguyen, MSN, FNP","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/ann_v_0.jpeg?h=4e4b0e22&itok=CxkStHng")
photo("Michele Kastelein, MD","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/michelle_k_0_0.jpeg?h=4f6395cb&itok=awtDUbT1")
photo("Robyn S. Tepper, MD, FAAFP","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/robyn_0_0.jpeg?h=a40292f0&itok=dlYDxiHL")
photo("Ammie Wilson Rodden, PA-C","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/ammie_rodden_0_0.jpeg?h=96e442c5&itok=9vC22dUc")
photo("Lisa Lommel, RN, PhD, FNP, MPH","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/stanford-person-default-profile-image.png?h=55541bb6&itok=nW2Kv8t1")
photo("Diana Farid, MD, MPH","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/diana_farid_headshot_0.jpeg?h=6cfcc0b6&itok=1h1Gg5HF")
photo("Doug D. Marania, MD","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/doug_0_0.jpeg?h=48751c22&itok=UTeP5GK3")
photo("Sandy Lai, MD","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/sandy_0_0.jpeg?h=92748315&itok=AAKMTNj4")
photo("Margaret Curry, RN, CTH","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/magaret_curry_0_0.jpeg?h=4565adf5&itok=hksQuSmf")
photo("Racquel Cua, PA","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/stanford-person-default-profile-image.png?h=55541bb6&itok=nW2Kv8t1")
photo("Danielle Hong, RN","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/stanford-person-default-profile-image.png?h=55541bb6&itok=nW2Kv8t1")
photo("Susanne Martin, MD","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/stanford-person-default-profile-image.png?h=55541bb6&itok=nW2Kv8t1")
photo("Swon Park, RN","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/stanford-person-default-profile-image.png?h=55541bb6&itok=nW2Kv8t1")
photo("Megan Gershon, RN","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/stanford-person-default-profile-image.png?h=55541bb6&itok=nW2Kv8t1")
photo("Karen Pendley, RN, BSN","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/stanford-person-default-profile-image.png?h=55541bb6&itok=nW2Kv8t1")

time(morning)
time(afternoon)
place(east)
place(west)

</textarea>

<textarea id="library" style="display:none;" type="text/hrf">
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Rules
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

area(AREA,N) :- hasDiseaseDanger(AREA, N)

rows(doctortab,L) :- setofall(doctortab(T,DOCTOR,N,M),doctortab(T,DOCTOR,N,M),L)

doctortab(T,DOCTOR,N,M) :-
  photo(DOCTOR,PHOTO) &
  normalizedDocRelevance(DOCTOR,N) &
  doctorFullName(LAST,DOCTOR) & 
  doctorCats(LAST,M) & 
  stringappend("<img src=&#39;",PHOTO,"&#39; width=&#39;70&#39; height=&#39;70&#39; title=&#39;",DOCTOR,"&#39;/>",T)

style(doctortab,visibility,visible) :- value(showrecs,true)
style(doctortab,visibility,hidden) :- ~value(showrecs,true)

style(row(X),"background-color","rgba(255, 228, 242, 0.8)") :- bcolor(none,X)

style(d(X),display,"table-row") :-
  symptom(X) &
  value(X,true)

style(d(X),display,none) :-
  course(X,Y) &
  ~value(X,true)

style(chart,display,"block") :-
  value(showcats,true)

style(chart,display,none) :-
  ~value(showcats,true)

style(locquestion, display, "block") :- value(askloc,true)
style(locquestion, display, none) :- ~value(askloc,true)

style(timequestion, display, "block") :- value(asktime,true)
style(timequestion, display, none) :- ~value(asktime,true)

innerhtml(u(X),V) :-
  symptom(X) &
  value(X,true) &
  value(units(X),V)

innerhtml(t,T) :- totalunits(T)

satisfied(c1) :-
  countofall([X], symptom(X) & value(X,true), C) &
  min(C,1,1)

first(X!Y,X)

req(c1)

style(R,color,red) :- req(R) & ~satisfied(R)
style(R,color,black) :- req(R) & satisfied(R)

select(X,true) :: ~value(X,false) & value(X,true) & addUserSymptom(X)
select(X,false) :: ~value(X,true) & value(X,false) & delUserSymptom(X)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

leq(X,Y) :- evaluate(stringmin(X,Y),X)
leqNum(X,Y) :- evaluate(min(X,Y),X)
primitive(X) :- symptom(X)
primitive(X) :- category(X)
list(nil)
list(cons(X,Y)) :- object(X) &  list(Y)
object(X) :- primitive(X)

mem(X,X!L) :- list(L)
mem(X,Y!L) :- leq(Y,X) & mem(X,L)

subset(nil,Y) :- list(Y)
subset(X!L,Y) :- mem(X,Y) & subset(L,Y)

intersection(nil,Y,nil) :- list(Y)
intersection(X!L,Y,X!Z) :- mem(X,Y) & intersection(L,Y,Z)
intersection(X!L,Y,Z) :- ~mem(X,Y) & intersection(L,Y,Z)

minTemp(C,[])
minTemp(C, M!X) :- evaluate(stringmin(C,M),C) & minTemp(C,X)
listMin(L, X) :- member(X,L) & minTemp(X,L)

del(X,[],[])
del(X,Y!L1,Z!L2) :- distinct(X,Y) & same(Y,Z) & del(X, L1, L2)
del(X,Y!L1,L2) :- same(X,Y) & del(X,L1,L2)

sorted([],[])
sorted(X, M!Y) :- listMin(X,M) & del(M, X, XM) & sorted(XM, Y)

addUserSymptom(X) :: symptom(X) ==> hasSymptom(X)
delUserSymptom(X) :: symptom(X) ==> ~hasSymptom(X)
addSymptom(X) :: symptom(X)
addSymptomList(X!L) :: symptom(X)
addSymptomList(X!L) :: evaluate(length(X!L), N) & leqNum(2,N) ==> addSymptomList(L)

addCat(X) :: category(X)
addCatList(X!L) :: category(X)
addCatList(X!L) :: evaluate(length(X!L), N) & leqNum(2,N) ==> addCatList(L)

allSymptoms(Z) :- evaluate(setofall(X, symptom(X)), Y) & sorted(Y,Z)
allDiseases(Z) :- evaluate(setofall(X, category(X)), Y) & sorted(Y,Z)
allUserSymptoms(Z) :- evaluate(setofall(X, hasSymptom(X)), Y) & sorted(Y,Z)

addSymSet(D, S, N) :: category(D) & list(S) & sorted(S, S2) ==> categorySymptomSet(D,S2, N)

addDoctor(X) :: doctor(X)
addDoctorList(X!L) :: doctor(X)
addDoctorList(X!L) :: evaluate(length(X!L), N) & leqNum(2,N) ==> addDoctorList(L)
defineDocDiseases(D, L) :: doctor(D) & allDiseases(T) & subset(L, T) & sorted(L,S) ==> doctorCats(D,S)
defineDocDiseases(D, L) :: doctorCats(D,S2) & doctor(D) & allDiseases(T) & subset(L, T) & sorted(L,S) & distinct(S,S2) ==> ~doctorCats(D,S2)

hasCategory(X) :- hasCategorySymptomSet(X, Z, N)

patientDiseases(L) :- evaluate(setofall(D, hasCategory(D)),K) & sorted(K,L)

hasCategorySymptomSet(X, Z, N) :- category(X) & categorySymptomSet(X, Z, N) & allUserSymptoms(S) & subset(Z, S)

hasDiseaseDanger(X, M) :- hasCategory(X) & evaluate(maximum(setofall(N, hasCategorySymptomSet(X, Z, N))),M)

patientDoctorOverlap(D, I) :- doctor(D) & doctorCats(D,S) & patientDiseases(L) & intersection(S,L,I)

doctorRelevance(D, N) :- patientDoctorOverlap(D, I) & evaluate(sum(setofall(M, member(X,I) & hasDiseaseDanger(X, M))), N)

docFullRelevance(F,N) :- doctorFullName(D,F) & doctorRelevance(D, N)

userPlace(P) :- place(P) & value(P,true)
userTime(T) :- time(T) & value(T,true)

timePreference(T) :: time(T) ==> userTime(T)
placePreference(P) :: place(P) ==> userPlace(P)

filteredDoctorRelevance(D, N) :- doctorPlace(D,P) & doctorTime(D,T) & userPlace(P1) & userTime(T1) & same(P,P1) & same(T,T1) & doctorRelevance(D, N)

filteredDocFullRelevance(F,N) :- doctorFullName(D,F) & filteredDoctorRelevance(D, N)

maxRelevance(M) :- evaluate(maximum(setofall(N, docFullRelevance(F,N))),M)

multFactor(N) :- maxRelevance(M) & evaluate(quotient(round(times(quotient(5,M),100)),100), N)

normalizedDocRelevance(F,N) :- multFactor(M) & docFullRelevance(F,K) & evaluate(round(times(K,M)),N)

filteredNormalizedDoctorRelevance(F, N) :- doctorFullName(D,F) & doctorPlace(D,P) & doctorTime(D,T) & userPlace(P1) & userTime(T1) & same(P,P1) & same(T,T1) & normalizedDocRelevance(F, N)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


</textarea>

</body>

</html>
