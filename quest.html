<html>
<head>
  <title></title>
  <meta charset="UTF-8">
  <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">
<script src="https://www.kryogenix.org/code/browser/sorttable/sorttable.js"></script>
  <script src="http://epilog.stanford.edu//epilog/javascript/epilog.js"></script>
  <script src="http://epilog.stanford.edu//worksheets/javascript/worksheets.js"></script>
        <script src="http://epilog.stanford.edu//worksheets/widgets/charts.js"></script></head>
<body onload="initialize()">
<table class="content-center" style="margin: 0px auto; width: 500px;">
  <tbody>

    <tr>
      
    <td colspan="4"><a href="https://vaden.stanford.edu/"><img src="header.png" alt="Vaden Health Services" width="375" height="50" style="margin: 0px auto;"></a>
    </tr>
    <tr>
      <td colspan="4"><span style="font-size:20px;"><strong>&nbsp;Clinician Recommendation Form&nbsp;</strong>
    </tr>

    <tr>
      <td colspan="4" style="color: black;"><em>&nbsp;What you describe as your primary medical concerns?</em></td>
    </tr>
    <tr>
      <td colspan="4" id="c1" style="color: red;"><em>&nbsp; - Please select at least one concern</em></td>
    </tr>
    <tr>
      <td colspan="4">
      <table border="0" cellpadding="0" cellspacing="0" style="width: 100%; border-collapse: collapse; margin: 0px auto; font-family: HelveticaNeue-Light, &quot;Helvetica Neue&quot;, Helvetica, sans-serif;">
        <tbody>
          <tr>
            <td id="row(gennutrition)" style="width: 25%; background-color: rgba(239, 72, 54, 0.298039);"><input id="gennutrition" onchange="modcheck(this)" type="checkbox" />&nbsp;General Nutrition</td>
            <td id="row(eatdisorder)" style="width: 25%; background-color: rgba(34, 167, 240, 0.298039);"><input id="eatdisorder" onchange="modcheck(this)" type="checkbox" />&nbsp;Eating Disorder</td>
            <td id="row(rash)" style="width: 25%; background-color: rgba(34, 167, 240, 0.298039);"><input id="rash" onchange="modcheck(this)" type="checkbox">&nbsp;Rash</td>
          </tr>
          <tr>
            <td id="row(acne)" style="width: 25%; background-color: rgba(239, 72, 54, 0.298039);"><input id="acne" onchange="modcheck(this)" type="checkbox" />&nbsp;Acne</td>
            <td id="row(genskin)" style="width: 25%; background-color: rgba(239, 72, 54, 0.298039);"><input id="genskin" onchange="modcheck(this)" type="checkbox" />&nbsp;Other skin</td>
            <td id="row(fever)" style="width: 25%; background-color: rgba(239, 72, 54, 0.298039);"><input id="fever" onchange="modcheck(this)" type="checkbox" />&nbsp;Fever</td>
          </tr>
          <tr>
            <td id="row(anxiety)" style="background-color: rgba(34, 167, 240, 0.298039);"><input id="anxiety" onchange="modcheck(this)" type="checkbox" />&nbsp;Anxiety</td>
            <td id="row(depression)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="depression" onchange="modcheck(this)" type="checkbox" />&nbsp;Depression</td>
            <td id="row(skinirritation)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="skinirritation" onchange="modcheck(this)" type="checkbox" />&nbsp;Skin Irritation</td>
          </tr>
          <tr>
            <td id="row(diarrhea)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="diarrhea" onchange="modcheck(this)" type="checkbox" />&nbsp;Diarrhea</td>
            <td id="row(jointpain)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="jointpain" onchange="modcheck(this)" type="checkbox" />&nbsp;Joint Pain</td>
            <td id="row(wheeze)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="wheeze" onchange="modcheck(this)" type="checkbox" />&nbsp;Wheezing</td>
          </tr>

          <tr>
            <td id="row(palpitations)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="palpitations" onchange="modcheck(this)" type="checkbox" />&nbsp;Palpitations</td>
            <td id="row(vertigo)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="vertigo" onchange="modcheck(this)" type="checkbox" />&nbsp;Vertigo</td>
            <td id="row(headache)" style="background-color: rgba(255, 228, 242, 0.8);"><input id="headache" onchange="modcheck(this)" type="checkbox" />&nbsp;Headache</td>
          </tr>
        </tbody>
      </table>
      <!---
      <tr>
      <td id="row(askloc)" style=""><input id="askloc" onchange="modcheck(this)" type="checkbox" />&nbsp;Do you have a location preference?</td>
    </tr>
    <tr>
      <td id="row(asktime)" style=""><input id="asktime" onchange="modcheck(this)" type="checkbox" />&nbsp;Do you have a time preference?</td>
    </tr>
    --->
      </td>
    </tr>
    <tr style="vertical-align: top;">
      <td colspan="4">
      <table border="0" cellpadding="0" cellspacing="0" style="width: 100%;">
        <tbody>
          <tr style="vertical-align: top;">
            <td>
          <tr>
            <td id="row(showcats)" style="background-color: rgba(34, 167, 240, 0.298039);"><input id="showcats" onchange="modcheck(this)" type="checkbox" />&nbsp;Show care topic categories?</td>
          </tr>
          <tr>
            <td id="row(showrecs)" style="background-color: rgba(34, 167, 240, 0.298039);"><input id="showrecs" onchange="modcheck(this)" type="checkbox"/>&nbsp;Show care provider recommendations?</td>
          </tr>
              <chart chart-line-color="white" class="chart" widget="chart" style="display: none;" chart-table="area" chart-type="pie" chart-title="Medical Categories" chart-y-axis-title="" chart-x-axis-title="" chart-color="" chart-data-range-labels="" chart-grid-lines="none" chart-legend="bottom" chart-line-width="" id="chart" ><canvas></canvas></chart>
            </td>          <td>
              <table class="sortable" table border="0" cellpadding="0" cellspacing="0" type='table' id="doctortab" style="width: 200px; font-family: HelveticaNeue-Light, 'Helvetica Neue', Helvetica, sans-serif; margin: 0px auto; text-align: center; visibility: hidden;">
                <thead>
                  <tr>
                    <th displaystyle="stringfield">Doctor</th>
                    <th>Relevance</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                  </tr>
                </tbody>
              </table>
            </td>
          </tr>
        </tbody>
      </table>
      </td>
    </tr>
  </tbody>
</table>
</div>

<textarea id="lambda" style="display:none;" type="text/hrf">
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Data
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

disease("adolescent")
disease("dermatology")
disease("preventive")
disease("sports")
disease("travel")
disease("urgent")
disease("women")
disease("mental")
disease("nutrition")

symptom(diarrhea)
symptom(wheeze)
symptom(gennutrition)
symptom(anxiety)
symptom(abdominalpain)
symptom(chestpain)
symptom(cough)
symptom(depression)
symptom(fever)
symptom(headache)
symptom(heartburn)
symptom(itch)
symptom(jointpain)
symptom(lossofsmell)
symptom(palpitations)
symptom(runnynose)
symptom(shortbreath)
symptom(skinirritation)
symptom(throatpain)

value(units(diarrhea),3)
value(units(wheeze),3)
value(units(abdominalpain),3)
value(units(chestpain),3)
value(units(skinirritation),3)
value(units(depression),3)
value(units(vertigo),3)
value(units(jointpain),3)

concern(diarrhea,"nutrition")
concern(jointpain,"nutrition")
concern(wheeze,"urgent")
concern(gennutrition,"nutrition")
concern(eatdisorder,"nutrition")
concern(rash,"dermatology")
concern(acne,"dermatology")
concern(genskin,"dermatology")
concern(sinjury,"sports")
concern(sperformance,"sports")
concern(fever,"urgent")
concern(depression,"mental")
concern(anxiety,"mental")
concern(itch,"dermatology")
concern(skinirritation,"dermatology")
concern(headache,"urgent")
concern(vertigo,"urgent")
concern(joint,"sports")
concern(chestpain,"urgent")
concern(palpitations,"urgent")

value(units(gennutrition),3)
value(units(eatdisorder),3)
value(units(depression),3)
value(units(rash),3)
value(units(acne),3)
value(units(fever),3)
value(units(genskin),3)
value(units(sinjury),3)
value(units(sperformance),3)
value(units(depression),3)
value(units(anxiety),3)
value(units(itch),3)
value(units(skinirritation),3)
value(units(headache),3)
value(units(vertigo),3)
value(units(joint),3)
value(units(chestpain),3)
value(units(palpitations),3)


bcolor(none,gennutrition)
bcolor(none,depression)
bcolor(none,rash)
bcolor(none,acne)
bcolor(none,fever)
bcolor(none,genskin)
bcolor(none,sperformance)
bcolor(none,sinjury)
bcolor(none,eatdisorder)
bcolor(none,anxiety)

bcolor(none,gennutrition)
bcolor(none,depression)
bcolor(none,rash)
bcolor(none,acne)
bcolor(none,fever)
bcolor(none,genskin)
bcolor(none,sperformance)
bcolor(none,sinjury)
bcolor(none,eatdisorder)
bcolor(none,anxiety)

doctor("COLLOFF")
doctor("CUA")
doctor("CURRY")
doctor("DAWSON")
doctor("FARID")
doctor("GERSHON")
doctor("HONG")
doctor("KASTELEIN")
doctor("LAI")
doctor("LOMMEL")
doctor("MARANIA")
doctor("MARTIN")
doctor("PARK")
doctor("PENDLEY")
doctor("RICHARDS")
doctor("RODDEN")
doctor("STOLL")
doctor("TEPPER")
doctor("VU-NGUYEN")
doctorTime("COLLOFF",morning)
doctorTime("CUA",morning)
doctorTime("CURRY",morning)
doctorTime("DAWSON",morning)
doctorTime("FARID",morning)
doctorTime("GERSHON",morning)
doctorTime("HONG",morning)
doctorTime("KASTELEIN",morning)
doctorTime("LAI",morning)
doctorTime("LOMMEL",morning)
doctorTime("MARANIA",morning)
doctorTime("MARTIN",afternoon)
doctorTime("PARK",afternoon)
doctorTime("PENDLEY",afternoon)
doctorTime("RICHARDS",afternoon)
doctorTime("RODDEN",afternoon)
doctorTime("STOLL",afternoon)
doctorTime("TEPPER",afternoon)
doctorTime("VU-NGUYEN",afternoon)
doctorPlace("COLLOFF",east)
doctorPlace("CUA",west)
doctorPlace("CURRY",east)
doctorPlace("DAWSON",west)
doctorPlace("FARID",east)
doctorPlace("GERSHON",west)
doctorPlace("HONG",east)
doctorPlace("KASTELEIN",west)
doctorPlace("LAI",east)
doctorPlace("LOMMEL",west)
doctorPlace("MARANIA",east)
doctorPlace("MARTIN",west)
doctorPlace("PARK",east)
doctorPlace("PENDLEY",west)
doctorPlace("RICHARDS",east)
doctorPlace("RODDEN",west)
doctorPlace("STOLL",east)
doctorPlace("TEPPER",west)
doctorPlace("VU-NGUYEN",east)

diseaseSymptomSet("dermatology",[itch,skinirritation],12)
diseaseSymptomSet("dermatology",[itch],5)
diseaseSymptomSet("dermatology",[skinirritation],5)
diseaseSymptomSet("adolescent",[itch,skinirritation],6)
diseaseSymptomSet("adolescent",[itch],2)
diseaseSymptomSet("adolescent",[skinirritation],3)
diseaseSymptomSet("sports",[headache,vertigo],10)
diseaseSymptomSet("sports",[headache],2)
diseaseSymptomSet("sports",[jointpain],5)
diseaseSymptomSet("sports",[vertigo],2)
diseaseSymptomSet("sports",[abdominalpain],4)
diseaseSymptomSet("sports",[abdominalpain,jointpain],8)
diseaseSymptomSet("urgent",[chestpain,headache,palpitations],100)
diseaseSymptomSet("urgent",[chestpain,shortbreath,wheeze],50)
diseaseSymptomSet("urgent",[chestpain,shortbreath],25)
diseaseSymptomSet("urgent",[chestpain,palpitations],15)
diseaseSymptomSet("urgent",[chestpain],4)
diseaseSymptomSet("urgent",[palpitations],5)
diseaseSymptomSet("preventive",[chestpain,headache,palpitations],100)
diseaseSymptomSet("preventive",[chestpain,palpitations,shortbreath],15)
diseaseSymptomSet("preventive",[chestpain],8)
diseaseSymptomSet("preventive",[palpitations],8)
diseaseSymptomSet("preventive",[abdominalpain],8)
diseaseSymptomSet("preventive",[shortbreath],8)
diseaseSymptomSet("preventive",[runnynose],8)
diseaseSymptomSet("preventive",[throatpain],8)
diseaseSymptomSet("preventive",[wheeze],8)
diseaseSymptomSet("mental",[depression],10)
diseaseSymptomSet("mental",[anxiety],10)
diseaseSymptomSet("mental",[anxiety,depression],20)
diseaseSymptomSet("nutrition",[gennutrition],10)
diseaseSymptomSet("nutrition",[jointpain],4)
diseaseSymptomSet("nutrition",[diarrhea],6)
diseaseSymptomSet("nutrition",[diarrhea,jointpain],9)

doctorFullName("PENDLEY","Karen Pendley, RN, BSN")
doctorFullName("COLLOFF","Edwin Colloff, MD")
doctorFullName("RICHARDS","Julie Richards, NP, CTH")
doctorFullName("STOLL","Nancy Stoll, RN, MS, BC")
doctorFullName("DAWSON","Laurel Dawson, MD")
doctorFullName("VU-NGUYEN","Ann Vu-Nguyen, MSN, FNP")
doctorFullName("KASTELEIN","Michele Kastelein, MD")
doctorFullName("TEPPER","Robyn S. Tepper, MD, FAAFP")
doctorFullName("RODDEN","Ammie Wilson Rodden, PA-C")
doctorFullName("LOMMEL","Lisa Lommel, RN, PhD, FNP, MPH")
doctorFullName("FARID","Diana Farid, MD, MPH")
doctorFullName("MARANIA","Doug D. Marania, MD")
doctorFullName("LAI","Sandy Lai, MD")
doctorFullName("CURRY","Margaret Curry, RN, CTH")
doctorFullName("CUA","Racquel Cua, PA")
doctorFullName("HONG","Danielle Hong, RN")
doctorFullName("MARTIN","Susanne Martin, MD")
doctorFullName("PARK","Swon Park, RN")
doctorFullName("GERSHON","Megan Gershon, RN")

doctorDiseases("COLLOFF",["preventive"])
doctorDiseases("CUA",["urgent","women"])
doctorDiseases("CURRY",["adolescent","preventive"])
doctorDiseases("DAWSON",["preventive","women"])
doctorDiseases("FARID",["dermatology","preventive","women"])
doctorDiseases("GERSHON",["nutrition","mental","preventive"])
doctorDiseases("HONG",["adolescent"])
doctorDiseases("KASTELEIN",["preventive","sports","women"])
doctorDiseases("LAI",["preventive"])
doctorDiseases("LOMMEL",["adolescent","women"])
doctorDiseases("MARANIA",["sports"])
doctorDiseases("MARTIN",["adolescent","sports","urgent"])
doctorDiseases("PARK",["nutrition","preventive","sports"])
doctorDiseases("PENDLEY",["preventive"])
doctorDiseases("RICHARDS",["travel"])
doctorDiseases("RODDEN",["preventive","sports","women"])
doctorDiseases("STOLL",["adolescent","preventive","travel"])
doctorDiseases("TEPPER",["adolescent","nutrition","women"])
doctorDiseases("VU-NGUYEN",["adolescent","women"])


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Rules
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
</textarea>

<textarea id="library" style="display:none;" type="text/hrf">
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Rules
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


area(AREA,N) :- hasDiseaseDanger(AREA, N)

rows(doctortab,L) :- setofall(doctortab(T,N),doctortab(T,N),L)


doctorOLD(T,N) :-
  treats(DOCTOR,X) &
  countofall(TAG,treats(DOCTOR,TAG)&value(TAG,true),N) &
  min(N,1,1) &
  photo(DOCTOR,PHOTO) &
  stringappend("<img src=&#39;",PHOTO,"&#39; width=&#39;70&#39; height=&#39;70&#39; title=&#39;",DOCTOR,"&#39;/>",T)

photo("Edwin Colloff, MD","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/ed_colloff_0_0.jpeg?h=9a223a1b&itok=cU1EsdFK")
photo("Julie Richards, NP, CTH","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/julie_0_0.jpeg?h=804a83ea&itok=_NY7PAzn")
photo("Nancy Stoll, RN, MS, BC","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/nancy_0_0.jpeg?h=92748315&itok=da5q70R5")
photo("Laurel Dawson, MD","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/larurel_0.jpeg?h=cee2c3b2&itok=HAFUwBdr")
photo("Ann Vu-Nguyen, MSN, FNP","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/ann_v_0.jpeg?h=4e4b0e22&itok=CxkStHng")
photo("Michele Kastelein, MD","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/michelle_k_0_0.jpeg?h=4f6395cb&itok=awtDUbT1")
photo("Robyn S. Tepper, MD, FAAFP","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/robyn_0_0.jpeg?h=a40292f0&itok=dlYDxiHL")
photo("Ammie Wilson Rodden, PA-C","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/ammie_rodden_0_0.jpeg?h=96e442c5&itok=9vC22dUc")
photo("Lisa Lommel, RN, PhD, FNP, MPH","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/stanford-person-default-profile-image.png?h=55541bb6&itok=nW2Kv8t1")
photo("Diana Farid, MD, MPH","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/diana_farid_headshot_0.jpeg?h=6cfcc0b6&itok=1h1Gg5HF")
photo("Doug D. Marania, MD","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/doug_0_0.jpeg?h=48751c22&itok=UTeP5GK3")
photo("Sandy Lai, MD","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/sandy_0_0.jpeg?h=92748315&itok=AAKMTNj4")
photo("Margaret Curry, RN, CTH","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/magaret_curry_0_0.jpeg?h=4565adf5&itok=hksQuSmf")
photo("Racquel Cua, PA","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/stanford-person-default-profile-image.png?h=55541bb6&itok=nW2Kv8t1")
photo("Danielle Hong, RN","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/stanford-person-default-profile-image.png?h=55541bb6&itok=nW2Kv8t1")
photo("Susanne Martin, MD","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/stanford-person-default-profile-image.png?h=55541bb6&itok=nW2Kv8t1")
photo("Swon Park, RN","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/stanford-person-default-profile-image.png?h=55541bb6&itok=nW2Kv8t1")
photo("Megan Gershon, RN","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/stanford-person-default-profile-image.png?h=55541bb6&itok=nW2Kv8t1")
photo("Karen Pendley, RN, BSN","https://vaden.stanford.edu/sites/g/files/sbiybj20746/files/styles/medium_square/public/media/image/stanford-person-default-profile-image.png?h=55541bb6&itok=nW2Kv8t1")

doctortab(T,N) :-
  photo(DOCTOR,PHOTO) &
  normalizedDocRelevance(DOCTOR,N) &
  stringappend("<img src=&#39;",PHOTO,"&#39; width=&#39;70&#39; height=&#39;70&#39; title=&#39;",DOCTOR,"&#39;/>",T)

style(doctortab,visibility,visible) :- value(showrecs,true)
style(doctortab,visibility,hidden) :- ~value(showrecs,true)

style(row(X),"background-color","rgba(255, 228, 242, 0.8)") :- bcolor(none,X)

style(d(X),display,"table-row") :-
  concern(X,Y) &
  value(X,true)

style(d(X),display,none) :-
  course(X,Y) &
  ~value(X,true)

style(chart,display,"block") :-
  value(showcats,true)

style(chart,display,none) :-
  ~value(showcats,true) 

innerhtml(u(X),V) :-
  concern(X,Y) &
  value(X,true) &
  value(units(X),V)

totalunits(T) :- 
  setofall([V,X,Y],
    teaches(Y,X) & 
    value(X,true) & 
    value(units(X),V), S) &
  map(first,S,L) &
  sum(L,T)

innerhtml(t,T) :- totalunits(T)

satisfied(c1) :-
  countofall([X,Y], teaches(Y,X) & value(X,true), C) &
  min(C,6,6)

first(X!Y,X)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

style(R,color,red) :- req(R) & ~satisfied(R)
style(R,color,black) :- req(R) & satisfied(R)

req(c1)
req(c2)

value(units(X),1) :: concern(X)

select(X,true) :: ~value(X,false) & value(X,true) & addUserSymptom(X)
select(X,false) :: ~value(X,true) & value(X,false) & delUserSymptom(X)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


leq(X,Y) :- evaluate(stringmin(X,Y),X)
leqNum(X,Y) :- evaluate(min(X,Y),X)
primitive(X) :- symptom(X)
primitive(X) :- disease(X)
list(nil)
list(cons(X,Y)) :- object(X) &  list(Y)
object(X) :- primitive(X)

mem(X,X!L) :- list(L)
mem(X,Y!L) :- leq(Y,X) & mem(X,L)

subset(nil,Y) :- list(Y)
subset(X!L,Y) :- mem(X,Y) & subset(L,Y)

intersection(nil,Y,nil) :- list(Y)
intersection(X!L,Y,X!Z) :- mem(X,Y) & intersection(L,Y,Z)
intersection(X!L,Y,Z) :- ~mem(X,Y) & intersection(L,Y,Z)


minTemp(C,[])
minTemp(C, M!X) :- evaluate(stringmin(C,M),C) & minTemp(C,X)
listMin(L, X) :- member(X,L) & minTemp(X,L)

del(X,[],[])
del(X,Y!L1,Z!L2) :- distinct(X,Y) & same(Y,Z) & del(X, L1, L2)
del(X,Y!L1,L2) :- same(X,Y) & del(X,L1,L2)

sorted([],[])
sorted(X, M!Y) :- listMin(X,M) & del(M, X, XM) & sorted(XM, Y)

addUserSymptom(X) :: symptom(X) ==> hasSymptom(X)
delUserSymptom(X) :: symptom(X) ==> ~hasSymptom(X)
addSymptom(X) :: symptom(X)
addSymptomList(X!L) :: symptom(X)
addSymptomList(X!L) :: evaluate(length(X!L), N) & leqNum(2,N) ==> addSymptomList(L)

addDisease(X) :: disease(X)
addDiseaseList(X!L) :: disease(X)
addDiseaseList(X!L) :: evaluate(length(X!L), N) & leqNum(2,N) ==> addDiseaseList(L)

allSymptoms(Z) :- evaluate(setofall(X, symptom(X)), Y) & sorted(Y,Z)
allDiseases(Z) :- evaluate(setofall(X, disease(X)), Y) & sorted(Y,Z)
allUserSymptoms(Z) :- evaluate(setofall(X, hasSymptom(X)), Y) & sorted(Y,Z)

addSymSet(D, S, N) :: disease(D) & list(S) & sorted(S, S2) ==> diseaseSymptomSet(D,S2, N)

addDoctor(X) :: doctor(X)
addDoctorList(X!L) :: doctor(X)
addDoctorList(X!L) :: evaluate(length(X!L), N) & leqNum(2,N) ==> addDoctorList(L)
defineDocDiseases(D, L) :: doctor(D) & allDiseases(T) & subset(L, T) & sorted(L,S) ==> doctorDiseases(D,S)
defineDocDiseases(D, L) :: doctorDiseases(D,S2) & doctor(D) & allDiseases(T) & subset(L, T) & sorted(L,S) & distinct(S,S2) ==> ~doctorDiseases(D,S2)

hasDisease(X) :- hasDiseaseSymptomSet(X, Z, N)

patientDiseases(L) :- evaluate(setofall(D, hasDisease(D)),K) & sorted(K,L)

hasDiseaseSymptomSet(X, Z, N) :- disease(X) & diseaseSymptomSet(X, Z, N) & allUserSymptoms(S) & subset(Z, S)

hasDiseaseDanger(X, M) :- hasDisease(X) & evaluate(maximum(setofall(N, hasDiseaseSymptomSet(X, Z, N))),M)

patientDoctorOverlap(D, I) :- doctor(D) & doctorDiseases(D,S) & patientDiseases(L) & intersection(S,L,I)

doctorRelevance(D, N) :- patientDoctorOverlap(D, I) & evaluate(sum(setofall(M, member(X,I) & hasDiseaseDanger(X, M))), N)

docFullRelevance(F,N) :- doctorFullName(D,F) & doctorRelevance(D, N)

time(morning)
time(afternoon)
place(east)
place(west)
timePreference(T) :: time(T) ==> userPlace(T)
placePreference(P) :: place(P) ==> userPlace(P)


filteredDoctorRelevance(D, N) :- doctorPlace(D,P) & doctorTime(D,T) & userPlace(P1) & userTime(T1) & same(P,P1) & same(T,T1) & doctorRelevance(D, N)

filteredDocFullRelevance(F,N) :- doctorFullName(D,F) & filteredDoctorRelevance(D, N)


time(morning)
time(afternoon)
place(east)
place(west)
timePreference(T) :: time(T) ==> userPlace(T)
placePreference(P) :: place(P) ==> userPlace(P)

maxRelevance(M) :- evaluate(maximum(setofall(N, docFullRelevance(F,N))),M)

multFactor(N) :- maxRelevance(M) & evaluate(quotient(round(times(quotient(5,M),100)),100), N)

normalizedDocRelevance(F,N) :- multFactor(M) & docFullRelevance(F,K) & evaluate(round(times(K,M)),N)

filteredNormalizedDoctorRelevance(F, N) :- doctorFullName(D,F) & doctorPlace(D,P) & doctorTime(D,T) & userPlace(P1) & userTime(T1) & same(P,P1) & same(T,T1) & normalizedDocRelevance(F, N)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


</textarea>

</body>

</html>